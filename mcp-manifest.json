{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "code-audit-ts MCP Manifest",
  "description": "A manifest declaring the tools provided by the code-audit-ts CLI, following the philosophy of the Model-Context Protocol (MCP).",
  "type": "object",
  "properties": {
    "tools": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the tool, corresponding to a CLI sub-command."
          },
          "description": {
            "type": "string",
            "description": "A brief explanation of what the tool does."
          },
          "inputs": {
            "type": "object",
            "properties": {
              "root": { "type": "string", "description": "The root directory of the project to analyze.", "default": "." },
              "format": { "type": "string", "enum": ["md", "json"], "description": "The output format for the report." },
              "out": { "type": "string", "description": "The path to the output file." },
              "fail-on": { "type": "string", "enum": ["none", "warn", "error"], "description": "The severity level that will cause the command to exit with a non-zero status code." }
            }
          },
          "outputs": {
            "type": "object",
            "description": "Describes the primary file(s) generated by the tool.",
            "properties": {
              "report": { "type": "string", "description": "The main analysis report file (e.g., audit.md)." },
              "graph": { "type": "string", "description": "A Graphviz DOT file representing the import graph." },
              "duplicates": { "type": "string", "description": "A JSON file listing duplicate functions." },
              "grade": { "type": "string", "description": "A JSON file containing the project's grade and score." }
            }
          }
        },
        "required": ["name", "description"]
      },
      "examples": [
        {
          "name": "analyze",
          "description": "Analyzes the TypeScript codebase against a set of predefined rules and generates a report.",
          "inputs": {
            "root": { "default": "." },
            "format": { "default": "md" },
            "out": { "example": "audit.md" },
            "fail-on": { "default": "error" }
          },
          "outputs": {
            "report": "audit.md or stdout"
          }
        },
        {
          "name": "grade",
          "description": "Calculates a letter grade (A-F) for the project based on the analysis report.",
          "inputs": {
            "root": { "default": "." },
            "out": { "example": "grade.json" }
          },
          "outputs": {
            "grade": "grade.json or stdout"
          }
        },
        {
          "name": "dup",
          "description": "Finds logically duplicate functions within the codebase by hashing their normalized AST.",
          "inputs": {
            "root": { "default": "." },
            "out": { "example": "duplicates.json" }
          },
          "outputs": {
            "duplicates": "duplicates.json or stdout"
          }
        },
        {
          "name": "graph",
          "description": "Generates an import graph of the project and identifies clusters of related modules.",
          "inputs": {
            "root": { "default": "." },
            "out": { "example": "import-graph.dot" }
          },
          "outputs": {
            "graph": "import-graph.dot and import-graph.clusters.json"
          }
        }
      ]
    }
  }
}
